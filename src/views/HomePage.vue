<template>
  <div class="min-h-screen bg-gradient-to-br from-amber-50 via-orange-50 to-red-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900">
    <!-- è‹±é›„åŒºåŸŸ -->
    <section class="relative overflow-hidden">
      <!-- èƒŒæ™¯å›¾ç‰‡ -->
      <div class="absolute inset-0">
        <img 
          src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=1920&h=1080&fit=crop&crop=center"
          alt="è¯—è¯èƒŒæ™¯"
          class="w-full h-full object-cover opacity-20"
        >
        <div class="absolute inset-0 bg-gradient-to-r from-amber-600/20 to-orange-600/20"></div>
      </div>
      
      <!-- å†…å®¹ -->
      <div class="relative container mx-auto px-4 py-24 md:py-32">
        <div class="text-center max-w-4xl mx-auto">
          <h1 class="text-4xl md:text-6xl font-bold text-gray-900 dark:text-white mb-6 leading-tight">
            è¯—å¢ƒé›…é›†
            <span class="block text-2xl md:text-3xl font-normal text-amber-600 dark:text-amber-400 mt-2">
              AIè¯—è¯åˆ›ä½œå¹³å°
            </span>
          </h1>
          
          <p class="text-lg md:text-xl text-gray-700 dark:text-gray-300 mb-8 leading-relaxed">
            åœ¨è¿™é‡Œï¼Œä¼ ç»Ÿè¯—è¯ä¸ç°ä»£AIç›¸é‡<br>
            è®©æ¯ä¸€ä¸ªäººéƒ½èƒ½ä½“éªŒè¯—è¯åˆ›ä½œçš„ç¾å¦™
          </p>
          
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <button 
              @click="$emit('navigate', 'create')"
              class="btn btn-primary text-lg px-8 py-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all"
            >
              <span class="mr-2">âœ¨</span>
              å¼€å§‹AIåˆ›ä½œ
            </button>
            <button 
              @click="scrollToPoems"
              class="btn btn-outline text-lg px-8 py-3 bg-white/80 backdrop-blur-sm hover:bg-white transition-all"
            >
              <span class="mr-2">ğŸ“œ</span>
              æ¬£èµç»å…¸
            </button>
          </div>
        </div>
      </div>
      
      <!-- è£…é¥°å…ƒç´  -->
      <div class="absolute top-20 left-10 text-6xl opacity-10 animate-pulse">ğŸŒ¸</div>
      <div class="absolute top-40 right-20 text-4xl opacity-10 animate-pulse delay-1000">ğŸƒ</div>
      <div class="absolute bottom-20 left-20 text-5xl opacity-10 animate-pulse delay-2000">ğŸŒ™</div>
    </section>

    <!-- ç‰¹è‰²åŠŸèƒ½ -->
    <section class="py-16 bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm">
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">å¹³å°ç‰¹è‰²</h2>
          <p class="text-gray-600 dark:text-gray-400">èåˆä¼ ç»Ÿæ–‡åŒ–ä¸ç°ä»£ç§‘æŠ€ï¼Œæ‰“é€ å…¨æ–°çš„è¯—è¯ä½“éªŒ</p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <FeatureCard
            icon="ğŸ¤–"
            title="AIæ™ºèƒ½åˆ›ä½œ"
            description="å…ˆè¿›çš„AIæŠ€æœ¯ï¼Œæ ¹æ®æ‚¨çš„ä¸»é¢˜å’Œæƒ…æ„Ÿï¼Œç”Ÿæˆä¼˜ç¾çš„è¯—è¯ä½œå“"
          />
          <FeatureCard
            icon="ğŸ“š"
            title="ç»å…¸è¯—è¯åº“"
            description="æ”¶å½•å†ä»£ç»å…¸è¯—è¯ï¼Œé…æœ‰è¯¦ç»†æ³¨é‡Šå’Œèµæï¼Œä¼ æ‰¿æ–‡åŒ–ç²¾é«“"
          />
          <FeatureCard
            icon="ğŸŒ¸"
            title="ç¤¾åŒºäº’åŠ¨"
            description="ä¸è¯—è¯çˆ±å¥½è€…äº¤æµåˆ›ä½œå¿ƒå¾—ï¼Œåˆ†äº«ä½œå“ï¼Œå…±åŒæˆé•¿"
          />
        </div>
      </div>
    </section>

    <!-- ä»Šæ—¥æ¨è -->
    <section class="py-16">
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">ä»Šæ—¥æ¨è</h2>
          <p class="text-gray-600 dark:text-gray-400">ç²¾é€‰ç»å…¸è¯—è¯ï¼Œæ„Ÿå—åƒå¹´æ–‡åŒ–é­…åŠ›</p>
        </div>
        
        <!-- æ¯æ—¥ä¸€è¯— -->
        <div class="max-w-4xl mx-auto mb-12">
          <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 md:p-12 text-center">
            <div class="text-sm text-amber-600 dark:text-amber-400 font-medium mb-4">æ¯æ—¥ä¸€è¯—</div>
            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">{{ dailyPoem.title }}</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-6">{{ dailyPoem.author }} Â· {{ dailyPoem.dynasty }}</p>
            <div class="text-lg leading-relaxed text-gray-800 dark:text-gray-200 serif mb-6 whitespace-pre-line">
              {{ dailyPoem.content }}
            </div>
            <button 
              @click="viewPoemDetail(dailyPoem)"
              class="text-amber-600 hover:text-amber-700 font-medium transition-colors"
            >
              æŸ¥çœ‹è¯¦æƒ… â†’
            </button>
          </div>
        </div>
        
        <!-- çƒ­é—¨è¯—è¯ -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" ref="poemsSection">
          <PoemCard
            v-for="poem in featuredPoems"
            :key="poem.id"
            :poem="poem"
            @click="viewPoemDetail(poem)"
          />
        </div>
        
        <div class="text-center mt-8">
          <button 
            @click="loadMorePoems"
            :disabled="loading"
            class="btn btn-outline"
          >
            <span v-if="loading">åŠ è½½ä¸­...</span>
            <span v-else>æŸ¥çœ‹æ›´å¤š</span>
          </button>
        </div>
      </div>
    </section>

    <!-- åˆ›ä½œçµæ„Ÿ -->
    <section class="py-16 bg-gradient-to-r from-amber-100 to-orange-100 dark:from-gray-800 dark:to-gray-700">
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">åˆ›ä½œçµæ„Ÿ</h2>
          <p class="text-gray-600 dark:text-gray-400">ä»è¿™äº›ä¸»é¢˜å¼€å§‹ï¼Œåˆ›ä½œå±äºæ‚¨çš„è¯—è¯</p>
        </div>
        
        <div class="flex flex-wrap justify-center gap-4 mb-8">
          <button
            v-for="theme in inspirationThemes"
            :key="theme"
            @click="startCreationWithTheme(theme)"
            class="px-6 py-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-full hover:bg-amber-50 dark:hover:bg-gray-700 hover:text-amber-600 dark:hover:text-amber-400 transition-colors shadow-sm hover:shadow-md"
          >
            {{ theme }}
          </button>
        </div>
        
        <div class="text-center">
          <button 
            @click="$emit('navigate', 'create')"
            class="btn btn-primary"
          >
            ç«‹å³å¼€å§‹åˆ›ä½œ
          </button>
        </div>
      </div>
    </section>

    <!-- ç»Ÿè®¡æ•°æ® -->
    <section class="py-16 bg-white dark:bg-gray-800">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
          <StatCard
            :value="stats.totalPoems"
            label="æ”¶å½•è¯—è¯"
            icon="ğŸ“œ"
          />
          <StatCard
            :value="stats.totalUsers"
            label="æ³¨å†Œç”¨æˆ·"
            icon="ğŸ‘¥"
          />
          <StatCard
            :value="stats.totalCreations"
            label="AIåˆ›ä½œ"
            icon="âœ¨"
          />
          <StatCard
            :value="stats.totalLikes"
            label="è·å¾—ç‚¹èµ"
            icon="â¤ï¸"
          />
        </div>
      </div>
    </section>

    <!-- åº•éƒ¨CTA -->
    <section class="py-16 bg-gradient-to-r from-amber-600 to-orange-600 text-white">
      <div class="container mx-auto px-4 text-center">
        <h2 class="text-3xl font-bold mb-4">åŠ å…¥è¯—å¢ƒé›…é›†</h2>
        <p class="text-xl mb-8 opacity-90">ä¸åƒä¸‡è¯—è¯çˆ±å¥½è€…ä¸€èµ·ï¼Œæ¢ç´¢è¯—è¯åˆ›ä½œçš„æ— é™å¯èƒ½</p>
        <button 
          @click="$emit('navigate', 'community')"
          class="btn bg-white text-amber-600 hover:bg-gray-100 text-lg px-8 py-3"
        >
          åŠ å…¥ç¤¾åŒº
        </button>
      </div>
    </section>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'
import { DatabaseService } from '@/lib/database'
import type { ClassicPoem } from '@/lib/database'
import FeatureCard from '@/components/FeatureCard.vue'
import PoemCard from '@/components/PoemCard.vue'
import StatCard from '@/components/StatCard.vue'

// Emits
defineEmits<{
  navigate: [page: string, options?: any]
}>()

// å“åº”å¼æ•°æ®
const loading = ref(false)
const poemsSection = ref<HTMLElement>()

const dailyPoem = ref({
  id: '1',
  title: 'é™å¤œæ€',
  author: 'æç™½',
  dynasty: 'å”ä»£',
  content: 'åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚\nä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚'
})

const featuredPoems = ref<ClassicPoem[]>([])

const inspirationThemes = [
  'æ˜¥æ—¥è¸é’', 'ç§‹å¤œæ€å›', 'å±±æ°´ç”°å›­', 'ç¦»åˆ«ç›¸æ€',
  'è¾¹å¡å¾æˆ˜', 'å’ç‰©æŠ’æ€€', 'èŠ‚æ—¥åº†å…¸', 'äººç”Ÿæ„Ÿæ‚Ÿ'
]

const stats = ref({
  totalPoems: '10,000+',
  totalUsers: '50,000+',
  totalCreations: '100,000+',
  totalLikes: '500,000+'
})

// æ–¹æ³•
function scrollToPoems() {
  poemsSection.value?.scrollIntoView({ behavior: 'smooth' })
}

function viewPoemDetail(poem: any) {
  $emit('navigate', 'poem-detail', { poemId: poem.id, poemType: 'classic' })
}

function startCreationWithTheme(theme: string) {
  // è·³è½¬åˆ°åˆ›ä½œé¡µé¢å¹¶é¢„å¡«ä¸»é¢˜
  $emit('navigate', 'create', { theme })
}

async function loadMorePoems() {
  loading.value = true
  try {
    const { data } = await DatabaseService.getClassicPoems({
      limit: 6,
      offset: featuredPoems.value.length
    })
    featuredPoems.value.push(...data)
  } catch (error) {
    console.error('åŠ è½½è¯—è¯å¤±è´¥:', error)
  } finally {
    loading.value = false
  }
}

// ç”Ÿå‘½å‘¨æœŸ
onMounted(async () => {
  try {
    // åŠ è½½ç²¾é€‰è¯—è¯
    const { data } = await DatabaseService.getClassicPoems({ limit: 6 })
    featuredPoems.value = data
    
    // éšæœºé€‰æ‹©æ¯æ—¥ä¸€è¯—
    if (data.length > 0) {
      const randomIndex = Math.floor(Math.random() * data.length)
      dailyPoem.value = data[randomIndex]
    }
  } catch (error) {
    console.error('åŠ è½½æ•°æ®å¤±è´¥:', error)
  }
})
</script>

<style scoped>
.serif {
  font-family: "Noto Serif SC", "Songti SC", "STSong", "SimSun", "KaiTi", "Kaiti SC", serif;
  line-height: 1.8;
  letter-spacing: 0.05em;
}

@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
}

.animate-float {
  animation: float 3s ease-in-out infinite;
}
</style>
