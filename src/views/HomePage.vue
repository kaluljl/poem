<template>
  <div class="min-h-screen" style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);">
    <!-- è‹±é›„åŒºåŸŸ -->
    <section class="relative overflow-hidden">
      <!-- èƒŒæ™¯æ¸å˜ -->
      <div class="absolute inset-0" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);"></div>
      
      <!-- å†…å®¹ -->
      <div class="relative container mx-auto px-4 py-24 md:py-32">
        <div class="text-center max-w-4xl mx-auto">
          <!-- å“ç‰Œæ ‡è¯† -->
          <div style="width: 80px; height: 80px; background: linear-gradient(to bottom right, #3b82f6, #8b5cf6); border-radius: 50%; margin: 0 auto 24px; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);">
            <span style="color: white; font-size: 32px; font-weight: bold;">è¯—</span>
          </div>
          
          <h1 style="font-size: 3.5rem; font-weight: 800; color: #1f2937; margin-bottom: 16px; line-height: 1.1;">
            è¯—å¢ƒé›…é›†
            <span style="display: block; font-size: 1.5rem; font-weight: 400; color: #6b7280; margin-top: 8px;">
              AIè¯—è¯åˆ›ä½œå¹³å°
            </span>
          </h1>
          
          <p style="font-size: 1.25rem; color: #6b7280; margin-bottom: 32px; line-height: 1.6;">
            åœ¨è¿™é‡Œï¼Œä¼ ç»Ÿè¯—è¯ä¸ç°ä»£AIç›¸é‡<br>
            è®©æ¯ä¸€ä¸ªäººéƒ½èƒ½ä½“éªŒè¯—è¯åˆ›ä½œçš„ç¾å¦™
          </p>
          
          <div style="display: flex; flex-direction: column; gap: 16px; justify-content: center; align-items: center;">
            <button 
              @click="$emit('navigate', 'create')"
              style="background: linear-gradient(to right, #3b82f6, #8b5cf6); color: white; padding: 16px 32px; border-radius: 12px; border: none; font-size: 18px; font-weight: 600; cursor: pointer; box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3); transition: all 0.3s ease; transform: translateY(0);"
              @mouseover="$event.target.style.transform = 'translateY(-2px)'; $event.target.style.boxShadow = '0 15px 40px rgba(59, 130, 246, 0.4)'"
              @mouseout="$event.target.style.transform = 'translateY(0)'; $event.target.style.boxShadow = '0 10px 30px rgba(59, 130, 246, 0.3)'"
            >
              <span style="margin-right: 8px;">âœ¨</span>
              å¼€å§‹AIåˆ›ä½œ
            </button>
            <button 
              @click="scrollToPoems"
              style="background: white; color: #374151; padding: 16px 32px; border-radius: 12px; border: 2px solid #e5e7eb; font-size: 18px; font-weight: 600; cursor: pointer; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); transition: all 0.3s ease;"
              @mouseover="$event.target.style.background = '#f9fafb'; $event.target.style.borderColor = '#3b82f6'"
              @mouseout="$event.target.style.background = 'white'; $event.target.style.borderColor = '#e5e7eb'"
            >
              <span style="margin-right: 8px;">ğŸ“œ</span>
              æ¬£èµç»å…¸
            </button>
          </div>
        </div>
      </div>
      
      <!-- è£…é¥°å…ƒç´  -->
      <div style="position: absolute; top: 80px; left: 40px; font-size: 48px; opacity: 0.1; animation: float 3s ease-in-out infinite;">ğŸŒ¸</div>
      <div style="position: absolute; top: 160px; right: 80px; font-size: 32px; opacity: 0.1; animation: float 3s ease-in-out infinite 1s;">ğŸƒ</div>
      <div style="position: absolute; bottom: 80px; left: 80px; font-size: 40px; opacity: 0.1; animation: float 3s ease-in-out infinite 2s;">ğŸŒ™</div>
    </section>

    <!-- ç‰¹è‰²åŠŸèƒ½ -->
    <section style="padding: 64px 0; background: white;">
      <div class="container mx-auto px-4">
        <div style="text-align: center; margin-bottom: 48px;">
          <h2 style="font-size: 2.5rem; font-weight: 700; color: #1f2937; margin-bottom: 16px;">å¹³å°ç‰¹è‰²</h2>
          <p style="color: #6b7280; font-size: 1.125rem;">èåˆä¼ ç»Ÿæ–‡åŒ–ä¸ç°ä»£ç§‘æŠ€ï¼Œæ‰“é€ å…¨æ–°çš„è¯—è¯ä½“éªŒ</p>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 32px;">
          <div style="background: white; border-radius: 16px; padding: 32px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); border: 1px solid #e5e7eb; transition: all 0.3s ease;"
               @mouseover="$event.target.style.transform = 'translateY(-4px)'; $event.target.style.boxShadow = '0 8px 30px rgba(0, 0, 0, 0.12)'"
               @mouseout="$event.target.style.transform = 'translateY(0)'; $event.target.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.08)'">
            <div style="width: 64px; height: 64px; background: linear-gradient(to bottom right, #3b82f6, #8b5cf6); border-radius: 16px; display: flex; align-items: center; justify-content: center; margin-bottom: 24px;">
              <span style="font-size: 28px;">ğŸ¤–</span>
            </div>
            <h3 style="font-size: 1.5rem; font-weight: 600; color: #1f2937; margin-bottom: 12px;">AIæ™ºèƒ½åˆ›ä½œ</h3>
            <p style="color: #6b7280; line-height: 1.6;">å…ˆè¿›çš„AIæŠ€æœ¯ï¼Œæ ¹æ®æ‚¨çš„ä¸»é¢˜å’Œæƒ…æ„Ÿï¼Œç”Ÿæˆä¼˜ç¾çš„è¯—è¯ä½œå“</p>
          </div>
          
          <div style="background: white; border-radius: 16px; padding: 32px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); border: 1px solid #e5e7eb; transition: all 0.3s ease;"
               @mouseover="$event.target.style.transform = 'translateY(-4px)'; $event.target.style.boxShadow = '0 8px 30px rgba(0, 0, 0, 0.12)'"
               @mouseout="$event.target.style.transform = 'translateY(0)'; $event.target.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.08)'">
            <div style="width: 64px; height: 64px; background: linear-gradient(to bottom right, #10b981, #059669); border-radius: 16px; display: flex; align-items: center; justify-content: center; margin-bottom: 24px;">
              <span style="font-size: 28px;">ğŸ“š</span>
            </div>
            <h3 style="font-size: 1.5rem; font-weight: 600; color: #1f2937; margin-bottom: 12px;">ç»å…¸è¯—è¯åº“</h3>
            <p style="color: #6b7280; line-height: 1.6;">æ”¶å½•å†ä»£ç»å…¸è¯—è¯ï¼Œé…æœ‰è¯¦ç»†æ³¨é‡Šå’Œèµæï¼Œä¼ æ‰¿æ–‡åŒ–ç²¾é«“</p>
          </div>
          
          <div style="background: white; border-radius: 16px; padding: 32px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); border: 1px solid #e5e7eb; transition: all 0.3s ease;"
               @mouseover="$event.target.style.transform = 'translateY(-4px)'; $event.target.style.boxShadow = '0 8px 30px rgba(0, 0, 0, 0.12)'"
               @mouseout="$event.target.style.transform = 'translateY(0)'; $event.target.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.08)'">
            <div style="width: 64px; height: 64px; background: linear-gradient(to bottom right, #f59e0b, #d97706); border-radius: 16px; display: flex; align-items: center; justify-content: center; margin-bottom: 24px;">
              <span style="font-size: 28px;">ğŸŒ¸</span>
            </div>
            <h3 style="font-size: 1.5rem; font-weight: 600; color: #1f2937; margin-bottom: 12px;">ç¤¾åŒºäº’åŠ¨</h3>
            <p style="color: #6b7280; line-height: 1.6;">ä¸è¯—è¯çˆ±å¥½è€…äº¤æµåˆ›ä½œå¿ƒå¾—ï¼Œåˆ†äº«ä½œå“ï¼Œå…±åŒæˆé•¿</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ä»Šæ—¥æ¨è -->
    <section style="padding: 64px 0; background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);">
      <div class="container mx-auto px-4">
        <div style="text-align: center; margin-bottom: 48px;">
          <h2 style="font-size: 2.5rem; font-weight: 700; color: #1f2937; margin-bottom: 16px;">ä»Šæ—¥æ¨è</h2>
          <p style="color: #6b7280; font-size: 1.125rem;">ç²¾é€‰ç»å…¸è¯—è¯ï¼Œæ„Ÿå—åƒå¹´æ–‡åŒ–é­…åŠ›</p>
        </div>
        
        <!-- æ¯æ—¥ä¸€è¯— -->
        <div style="max-width: 800px; margin: 0 auto 48px;">
          <div style="background: white; border-radius: 20px; padding: 48px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); border: 1px solid #e5e7eb; text-align: center;">
            <div style="font-size: 14px; color: #3b82f6; font-weight: 600; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 0.5px;">æ¯æ—¥ä¸€è¯—</div>
            <h3 style="font-size: 2rem; font-weight: 700; color: #1f2937; margin-bottom: 8px;">{{ dailyPoem.title }}</h3>
            <p style="color: #6b7280; margin-bottom: 24px; font-size: 1.125rem;">{{ dailyPoem.author }} Â· {{ dailyPoem.dynasty }}</p>
            <div style="font-size: 1.25rem; line-height: 1.8; color: #374151; font-family: 'Noto Serif SC', serif; margin-bottom: 32px; white-space: pre-line;">
              {{ dailyPoem.content }}
            </div>
            <button 
              @click="viewPoemDetail(dailyPoem)"
              style="color: #3b82f6; font-weight: 600; background: none; border: none; cursor: pointer; font-size: 16px; transition: color 0.3s ease;"
              @mouseover="$event.target.style.color = '#1d4ed8'"
              @mouseout="$event.target.style.color = '#3b82f6'"
            >
              æŸ¥çœ‹è¯¦æƒ… â†’
            </button>
          </div>
        </div>
        
        <!-- çƒ­é—¨è¯—è¯ -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" ref="poemsSection">
          <PoemCard
            v-for="poem in featuredPoems"
            :key="poem.id"
            :poem="poem"
            @click="viewPoemDetail(poem)"
          />
        </div>
        
        <div class="text-center mt-8">
          <button 
            @click="loadMorePoems"
            :disabled="loading"
            class="btn btn-outline"
          >
            <span v-if="loading">åŠ è½½ä¸­...</span>
            <span v-else>æŸ¥çœ‹æ›´å¤š</span>
          </button>
        </div>
      </div>
    </section>

    <!-- åˆ›ä½œçµæ„Ÿ -->
    <section style="padding: 64px 0; background: white;">
      <div class="container mx-auto px-4">
        <div style="text-align: center; margin-bottom: 48px;">
          <h2 style="font-size: 2.5rem; font-weight: 700; color: #1f2937; margin-bottom: 16px;">åˆ›ä½œçµæ„Ÿ</h2>
          <p style="color: #6b7280; font-size: 1.125rem;">ä»è¿™äº›ä¸»é¢˜å¼€å§‹ï¼Œåˆ›ä½œå±äºæ‚¨çš„è¯—è¯</p>
        </div>
        
        <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 16px; margin-bottom: 32px;">
          <button
            v-for="theme in inspirationThemes"
            :key="theme"
            @click="startCreationWithTheme(theme)"
            style="padding: 12px 24px; background: white; color: #374151; border-radius: 50px; border: 2px solid #e5e7eb; font-weight: 500; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);"
            @mouseover="$event.target.style.background = '#f8fafc'; $event.target.style.borderColor = '#3b82f6'; $event.target.style.color = '#3b82f6'; $event.target.style.transform = 'translateY(-2px)'; $event.target.style.boxShadow = '0 4px 15px rgba(59, 130, 246, 0.2)'"
            @mouseout="$event.target.style.background = 'white'; $event.target.style.borderColor = '#e5e7eb'; $event.target.style.color = '#374151'; $event.target.style.transform = 'translateY(0)'; $event.target.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.05)'"
          >
            {{ theme }}
          </button>
        </div>
        
        <div style="text-align: center;">
          <button 
            @click="$emit('navigate', 'create')"
            style="background: linear-gradient(to right, #3b82f6, #8b5cf6); color: white; padding: 16px 32px; border-radius: 12px; border: none; font-size: 18px; font-weight: 600; cursor: pointer; box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3); transition: all 0.3s ease;"
            @mouseover="$event.target.style.transform = 'translateY(-2px)'; $event.target.style.boxShadow = '0 15px 40px rgba(59, 130, 246, 0.4)'"
            @mouseout="$event.target.style.transform = 'translateY(0)'; $event.target.style.boxShadow = '0 10px 30px rgba(59, 130, 246, 0.3)'"
          >
            ç«‹å³å¼€å§‹åˆ›ä½œ
          </button>
        </div>
      </div>
    </section>

    <!-- ç»Ÿè®¡æ•°æ® -->
    <section style="padding: 64px 0; background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);">
      <div class="container mx-auto px-4">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 32px; text-align: center;">
          <div style="background: white; border-radius: 16px; padding: 32px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); border: 1px solid #e5e7eb;">
            <div style="font-size: 2.5rem; margin-bottom: 8px;">ğŸ“œ</div>
            <div style="font-size: 2rem; font-weight: 700; color: #1f2937; margin-bottom: 4px;">{{ stats.totalPoems }}</div>
            <div style="color: #6b7280; font-weight: 500;">æ”¶å½•è¯—è¯</div>
          </div>
          <div style="background: white; border-radius: 16px; padding: 32px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); border: 1px solid #e5e7eb;">
            <div style="font-size: 2.5rem; margin-bottom: 8px;">ğŸ‘¥</div>
            <div style="font-size: 2rem; font-weight: 700; color: #1f2937; margin-bottom: 4px;">{{ stats.totalUsers }}</div>
            <div style="color: #6b7280; font-weight: 500;">æ³¨å†Œç”¨æˆ·</div>
          </div>
          <div style="background: white; border-radius: 16px; padding: 32px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); border: 1px solid #e5e7eb;">
            <div style="font-size: 2.5rem; margin-bottom: 8px;">âœ¨</div>
            <div style="font-size: 2rem; font-weight: 700; color: #1f2937; margin-bottom: 4px;">{{ stats.totalCreations }}</div>
            <div style="color: #6b7280; font-weight: 500;">AIåˆ›ä½œ</div>
          </div>
          <div style="background: white; border-radius: 16px; padding: 32px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); border: 1px solid #e5e7eb;">
            <div style="font-size: 2.5rem; margin-bottom: 8px;">â¤ï¸</div>
            <div style="font-size: 2rem; font-weight: 700; color: #1f2937; margin-bottom: 4px;">{{ stats.totalLikes }}</div>
            <div style="color: #6b7280; font-weight: 500;">è·å¾—ç‚¹èµ</div>
          </div>
        </div>
      </div>
    </section>

    <!-- åº•éƒ¨CTA -->
    <section style="padding: 64px 0; background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); color: white;">
      <div class="container mx-auto px-4" style="text-align: center;">
        <h2 style="font-size: 2.5rem; font-weight: 700; margin-bottom: 16px;">åŠ å…¥è¯—å¢ƒé›…é›†</h2>
        <p style="font-size: 1.25rem; margin-bottom: 32px; opacity: 0.9;">ä¸åƒä¸‡è¯—è¯çˆ±å¥½è€…ä¸€èµ·ï¼Œæ¢ç´¢è¯—è¯åˆ›ä½œçš„æ— é™å¯èƒ½</p>
        <button 
          @click="$emit('navigate', 'community')"
          style="background: white; color: #3b82f6; padding: 16px 32px; border-radius: 12px; border: none; font-size: 18px; font-weight: 600; cursor: pointer; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); transition: all 0.3s ease;"
          @mouseover="$event.target.style.background = '#f8fafc'; $event.target.style.transform = 'translateY(-2px)'; $event.target.style.boxShadow = '0 15px 40px rgba(0, 0, 0, 0.3)'"
          @mouseout="$event.target.style.background = 'white'; $event.target.style.transform = 'translateY(0)'; $event.target.style.boxShadow = '0 10px 30px rgba(0, 0, 0, 0.2)'"
        >
          åŠ å…¥ç¤¾åŒº
        </button>
      </div>
    </section>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'
import { DatabaseService } from '@/lib/database'
import type { ClassicPoem } from '@/lib/database'
import FeatureCard from '@/components/FeatureCard.vue'
import PoemCard from '@/components/PoemCard.vue'
import StatCard from '@/components/StatCard.vue'

// Emits
defineEmits<{
  navigate: [page: string, options?: any]
}>()

// å“åº”å¼æ•°æ®
const loading = ref(false)
const poemsSection = ref<HTMLElement>()

const dailyPoem = ref({
  id: '1',
  title: 'é™å¤œæ€',
  author: 'æç™½',
  dynasty: 'å”ä»£',
  content: 'åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚\nä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚'
})

const featuredPoems = ref<ClassicPoem[]>([])

const inspirationThemes = [
  'æ˜¥æ—¥è¸é’', 'ç§‹å¤œæ€å›', 'å±±æ°´ç”°å›­', 'ç¦»åˆ«ç›¸æ€',
  'è¾¹å¡å¾æˆ˜', 'å’ç‰©æŠ’æ€€', 'èŠ‚æ—¥åº†å…¸', 'äººç”Ÿæ„Ÿæ‚Ÿ'
]

const stats = ref({
  totalPoems: '10,000+',
  totalUsers: '50,000+',
  totalCreations: '100,000+',
  totalLikes: '500,000+'
})

// æ–¹æ³•
function scrollToPoems() {
  poemsSection.value?.scrollIntoView({ behavior: 'smooth' })
}

function viewPoemDetail(poem: any) {
  $emit('navigate', 'poem-detail', { poemId: poem.id, poemType: 'classic' })
}

function startCreationWithTheme(theme: string) {
  // è·³è½¬åˆ°åˆ›ä½œé¡µé¢å¹¶é¢„å¡«ä¸»é¢˜
  $emit('navigate', 'create', { theme })
}

async function loadMorePoems() {
  loading.value = true
  try {
    const { data } = await DatabaseService.getClassicPoems({
      limit: 6,
      offset: featuredPoems.value.length
    })
    featuredPoems.value.push(...data)
  } catch (error) {
    console.error('åŠ è½½è¯—è¯å¤±è´¥:', error)
  } finally {
    loading.value = false
  }
}

// ç”Ÿå‘½å‘¨æœŸ
onMounted(async () => {
  try {
    // åŠ è½½ç²¾é€‰è¯—è¯
    const { data } = await DatabaseService.getClassicPoems({ limit: 6 })
    featuredPoems.value = data
    
    // éšæœºé€‰æ‹©æ¯æ—¥ä¸€è¯—
    if (data.length > 0) {
      const randomIndex = Math.floor(Math.random() * data.length)
      dailyPoem.value = data[randomIndex]
    }
  } catch (error) {
    console.error('åŠ è½½æ•°æ®å¤±è´¥:', error)
  }
})
</script>

<style scoped>
.serif {
  font-family: "Noto Serif SC", "Songti SC", "STSong", "SimSun", "KaiTi", "Kaiti SC", serif;
  line-height: 1.8;
  letter-spacing: 0.05em;
}

@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
}

.animate-float {
  animation: float 3s ease-in-out infinite;
}
</style>
